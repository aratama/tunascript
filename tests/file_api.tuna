// expect: missing
// expect: write_error
// expect: not_exists
// expect: read_error
// expect: append_error
// expect: dir_error
// expect: missing_read_error

import { log } from "prelude"
import { read_text, write_text, append_text, read_dir, exists } from "file"

const filename: string = "file_api_test.txt"
const missing: string = "file_api_missing.txt"

export function main(): void {
  if (exists(missing)) {
    log("missing_exists")
  } else {
    log("missing")
  }

  const writeRes: undefined | error = write_text(filename, "hello")
  switch (writeRes) {
    case _ as undefined: log("write_ok")
    case _ as error: log("write_error")
  }

  if (exists(filename)) {
    log("exists")
  } else {
    log("not_exists")
  }

  const readRes: string | error = read_text(filename)
  switch (readRes) {
    case _ as string: log("read_ok")
    case _ as error: log("read_error")
  }

  const appendRes: undefined | error = append_text(filename, " world")
  switch (appendRes) {
    case _ as undefined: log("append_ok")
    case _ as error: log("append_error")
  }

  const dirRes: string[] | error = read_dir(".")
  switch (dirRes) {
    case _ as string[]: log("dir_ok")
    case _ as error: log("dir_error")
  }

  const missingRead: string | error = read_text(missing)
  switch (missingRead) {
    case _ as string: log("missing_read_unexpected")
    case _ as error: log("missing_read_error")
  }
}
